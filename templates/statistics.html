<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>Statistics and Reports</title>
    <link href="../static/css/common.css" rel="stylesheet">
    <link href="../static/css/navbar.css" rel="stylesheet">
    <link href="../static/css/statistics.css" rel="stylesheet">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.4/jquery.min.js"></script>
</head>

<body>
    <nav class="horizontal-navbar">
        <a href="/" class="logo">AutoSale</a>
        <ul class="nav-links">
            <li><a href="/" class="nav-link">Головна</a></li>
            <li><a href="profile" class="nav-link">Профіль</a></li>
            <li><a href="collections" class="nav-link">Управління</a></li>
            <li><a href="users" class="nav-link">Користувачі</a></li>
            <li><a href="statistics" class="nav-link">Статистика</a></li>
        </ul>
    </nav>

    <div class="statistics-container">
        <h2>Statistics and Reports</h2>

        <!-- Different sections for each query -->
        <div id="clients-info">
            <h3>1. Clients Information</h3>
            <button onclick="fetchAllClients()">All Clients</button>
            <button onclick="fetchClientsWithMultiplePurchases()">Clients with Multiple Purchases</button>
            <div id="clients-result"></div>
        </div>

        <div id="top-dealer-info">
            <h3>2. Dealer with Most Contracts in a Month</h3>
            <button onclick="fetchTopDealer()">Fetch Top Dealer</button>
            <div id="dealer-result"></div>
        </div>


        <div id="contracts-info">
            <h3>3. Contracts for Cars Bought on Credit</h3>
            <button onclick="fetchCreditContracts()">Fetch Credit Contracts</button>
            <div id="contracts-result"></div>
        </div>


    </div>

    <script>
        function fetchAllClients() {
            $.ajax({
                url: "/api/clients/all",
                type: "GET",
                success: function (response) {
                    $("#clients-result").html(JSON.stringify(response));
                },
                error: function (xhr, status, error) {
                    alert('Error fetching all clients: ' + xhr.responseText);
                }
            });
        }

        function fetchClientsWithMultiplePurchases() {
            $.ajax({
                url: "/api/clients/multiple-purchases",
                type: "GET",
                success: function (response) {
                    $("#clients-result").html(JSON.stringify(response));
                },
                error: function (xhr, status, error) {
                    alert('Error fetching clients with multiple purchases: ' + xhr.responseText);
                }
            });
        }

        function fetchTopDealer() {
            $.ajax({
                url: "/api/dealers/top",
                type: "GET",
                success: function (response) {
                    $("#dealer-result").html(JSON.stringify(response));
                },
                error: function (xhr, status, error) {
                    alert('Error fetching top dealer: ' + xhr.responseText);
                }
            });
        }

        function fetchCreditContracts() {
            $.ajax({
                url: "/api/contracts/credit",
                type: "GET",
                success: function (response) {
                    $("#contracts-result").html(JSON.stringify(response));
                },
                error: function (xhr, status, error) {
                    alert('Error fetching credit contracts: ' + xhr.responseText);
                }
            });
        }
    </script>
</body>

</html>